@if (manga$ | async; as manga) {
  <div class="container py-3">
    <div class="row g-3">
      <div class="col-12 col-md-4 col-lg-5">
        <img [src]="manga.coverUrl" [alt]="manga.title" class="img-fluid rounded">
      </div>
      <div class="col-12 col-md-8 col-lg-7">
        <div class="card">
          <div class="card-body">
            <h2 class="card-title mb-1">{{ manga.title }}</h2>
            <div class="text-muted small mb-2">by {{ manga.author }}</div>
            <div class="mb-2">
              <i class="fa-solid fa-star"></i>
              <span class="ms-1">{{ manga.rating }}/5</span>
            </div>
            <p class="card-text">{{ manga.description }}</p>
            <hr>
            <div class="chapters mt-3">
              @if (manga.volumes?.length) {
                <!-- Volumes -->
                @for (volume of manga.volumes; track volume.number) {
                  <div class="card mb-3 border-0">
                    <div class="row g-0">
                      <div class="col-md-4">
                        <img [src]="volume.coverUrl" [class.opacity-25]="!volume.chapters?.length"
                             class="img-fluid rounded" alt="volume cover image">
                      </div>
                      <div class="col-md-8">
                        <div class="card-body">
                          <h5 class="card-title">Volume {{ volume.number }}</h5>
                          <div class="card-text">
                            <div class="d-flex gap-1 flex-wrap" role="list" aria-label="Chapters list">
                              @if (volume.chapters?.length) {
                                <!-- Chapters -->
                                @for (chapter of volume.chapters; track chapter.number) {
                                  <a class="btn btn-outline-primary btn-lg"
                                     role="listitem"
                                     [routerLink]="['/manga', manga.id, 'volume', volume.number, 'chapter', chapter.number]"
                                     [attr.aria-label]="'Read chapter ' + chapter.number">
                                    {{ chapter.number }}
                                  </a>
                                }
                              } @else {
                                <div class="alert alert-warning text-center">
                                  <i class="fa-solid fa-circle-info"></i> No chapters available yet.
                                </div>
                              }
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                }
              } @else {
                <div class="alert alert-warning text-center">
                  <i class="fa-solid fa-circle-info"></i> No volumes available yet.
                </div>
              }
            </div>
            <div class="mt-3">
              <div class="text-muted small">Last updated: {{ manga.lastUpdated | date:'medium' }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="container py-5 text-center">
    <h3>Manga not found</h3>
    <a [routerLink]="['/']" class="btn btn-primary mt-2">Go Home</a>
  </div>
}
